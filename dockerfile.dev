
# syntax = docker/dockerfile:1

# Use Node.js as the base image
ARG NODE_VERSION=20.8.0
FROM node:lts as node_base
# FROM oven/bun:canary

# Set the working directory
WORKDIR /usr/src/app


# Set the environment to production
ENV NODE_ENV=production

# Install packages needed to build node modules
RUN apt-get update -qq && apt-get install -y

# Install Bun
RUN npm install -g pnpm

# Copy package files and lock files for Bun
# COPY package.json bun.lockb ./

# USER bun
# Install dependencies with Bun

# Copy your source code
COPY . .

RUN pnpm install
# Use npx to run Prisma generate

RUN pnpm run build

# Expose the port your app runs on
EXPOSE 3000/tcp

# Define the command to run your app using Bun
ENTRYPOINT [ "pnpm", "run", "start" ] 
